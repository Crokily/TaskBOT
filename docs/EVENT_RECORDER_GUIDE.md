# Discord事件自动录音功能使用指南

本指南介绍了如何使用TaskBOT的Discord事件自动录音功能。该功能可以自动检测Discord计划事件，在事件开始时加入语音频道并开始录音，在事件结束时停止录音并保存会议记录。

## 功能概述

- **自动录音**：机器人会自动检测即将开始的Discord事件，如果事件关联了语音频道，机器人会自动加入并开始录音
- **自动停止**：当事件结束时，机器人会自动停止录音，保存文件并上传到数据库
- **会议记录**：每次录音完成后，会生成一个包含会议信息的JSON文件
- **手动控制**：提供了手动开始和停止录音的命令

## 使用方法

### 创建Discord事件

1. 在Discord服务器中创建一个计划事件
2. 确保事件关联了一个语音频道
3. 可以在事件描述中添加`portfolio_id: XXX`来指定会议所属的项目组

### 自动录音

机器人会自动检测即将开始的事件，并在事件开始时加入语音频道开始录音。当事件结束时，机器人会自动停止录音并保存会议记录。

### 手动控制

如果需要手动控制录音过程，可以使用以下命令：

- `/list_events` - 列出服务器中的所有计划事件
- `/manual_record_event <event_id>` - 手动开始录制指定的事件
- `/stop_recording_event` - 手动停止当前的事件录制

## 会议记录格式

每次录音完成后，会生成一个JSON文件，包含以下信息：

```json
{
    "meeting_date": "2023-04-05",
    "meeting_name": "每周团队会议_2023-04-05",
    "portfolio_id": "IT",
    "recording_file_link": "D:/recordings/每周团队会议_2023-04-05.wav"
}
```

## 注意事项

1. 机器人需要有加入语音频道的权限
2. 确保事件关联了正确的语音频道
3. 如果需要指定portfolio_id，请在事件描述中添加`portfolio_id: XXX`
4. 如果没有指定portfolio_id，机器人会尝试使用频道分类名称作为portfolio_id
5. 录音文件会保存在临时目录中，并上传到Supabase数据库
